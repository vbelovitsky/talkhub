<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
{% include 'main/navbar.html' %}
<link rel="stylesheet" href="https://cdn.metroui.org.ua/v4/css/metro-all.min.css">
<script type="text/javascript">
    $(document).ready(function (event) {

        $('.reply-btn').click(function () {
            var pk = "#" + $(this).attr('value');
            $(pk).fadeToggle();
            console.log(pk)
        });

        $('#delete').click(function () {
            return confirm("Do you want to delete this post?");
        });

        $(document).on('click', '#like', function (event) {
            event.preventDefault();
            var pk = $(this).attr('value');
            $.ajax({
                type: 'POST',
                url: '{% url "like_post" %}',
                data: {
                    'id': pk,
                    'csrfmiddlewaretoken': '{{csrf_token}}'
                },
                dataType: 'json',
                success: function (response) {
                    $('#like-section').html(response['form']);
                },
                error: function (rs) {
                    console.log(rs.responseText)
                },
            });
        });

        $(document).on('submit', '.comment-form', function (event) {
            event.preventDefault();
            $.ajax({
                type: 'POST',
                url: $(this).attr('action'),
                data: $(this).serialize(),
                dataType: 'json',
                success: function (response) {
                    $('.main-comment-section').html(response['form']);
                    $('.reply-btn').click(function () {
                        var pk = "#" + $(this).attr('value');
                        $(pk).fadeToggle();
                        $('.textinputclass').val('');
                    });
                    $('.textinputclass').val('');
                },
                error: function (rs) {
                    console.log(rs.responseText);
                },
            });
        });

        $(document).on('submit', '.reply-form', function (event) {
            event.preventDefault();
            $.ajax({
                type: 'POST',
                url: $(this).attr('action'),
                data: $(this).serialize(),
                dataType: 'json',
                success: function (response) {
                    $('.main-comment-section').html(response['form']);
                    $('.reply-btn').click(function () {
                        var pk = "#" + $(this).attr('value');
                        $(pk).fadeToggle();
                        $('.textinputclass').val('');
                    });
                    $('.textinputclass').val('');
                },
                error: function (rs) {
                    console.log(rs.responseText);
                },
            });
        });

        $(document).on('click', '#comment-delete', function (event) {
            event.preventDefault();
            $.ajax({
                type: 'POST',
                url: $(this).attr('name'),
                data: {
                    'csrfmiddlewaretoken': '{{csrf_token}}'
                },
                dataType: 'json',
                success: function (response) {
                    $('.main-comment-section').html(response['form']);
                },
                error: function (rs) {
                    console.log(rs.responseText)
                },
            });
        });

        $(document).on('click', '#reply-delete', function (event) {
            event.preventDefault();
            $.ajax({
                type: 'POST',
                url: $(this).attr('name'),
                data: {
                    'csrfmiddlewaretoken': '{{csrf_token}}'
                },
                dataType: 'json',
                success: function (response) {
                    $('.main-comment-section').html(response['form']);
                },
                error: function (rs, e) {
                    console.log(rs.responseText)
                },
            });
        });

        $(document).on('click', '#refresh-button', function (event) {
            event.preventDefault();
            $.ajax({
                type: 'GET',
                url: $(this).attr('name'),
                data: {
                },
                dataType: 'json',
                success: function (response) {
                    $('.main-comment-section').html(response['form']);
                },
                error: function (rs) {
                    console.log(rs.responseText)
                },
            });
        });

        $(document).on('submit', '.tag-search-form', function (event) {
            event.preventDefault();
            qtag = $('#qtag').val();
            $.ajax({
                type: 'GET',
                url: $(this).attr('action'),
                data: {
                    'qtag': qtag
                },
                dataType: 'json',
                success: function (response) {
                    $('.tag-section').html(response['form']);
                },
                error: function (rs) {
                    console.log(rs.responseText);
                },
            });
        });


    });
</script>
</body>
<style>
    @media screen and (min-width: 800px){
            {% include 'main/styles-big.css' %}
    }
    @media screen and (max-width: 800px){
            {% include 'main/styles-small.css' %}
    }
</style>